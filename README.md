# UDP通信应用

## 项目概述

UDP通信应用是一个基于Qt框架开发的网络通信工具，采用模块化架构设计，实现了用户认证、本地/远程UDP通信等功能。该应用程序允许用户通过UDP协议进行数据传输和接收，支持本地模式和远程模式，并确保两种模式不能同时运行。

## 主要功能

1. **用户认证系统**：实现安全的登录界面，验证用户身份
2. **双模式通信**：
   - **本地模式**：在本地计算机上不同端口之间进行UDP数据交换
   - **远程模式**：与远程UDP服务器进行通信
3. **网络连接管理**：
   - 提供IP地址和端口配置界面
   - 连接前的Ping测试功能
   - 连接状态实时更新
4. **实时消息交互**：
   - 消息发送和接收功能
   - 消息记录（含时间戳和发送者信息）
5. **模式互斥控制**：确保本地和远程模式不能同时运行
6. **完整日志系统**：记录系统运行状态和用户操作

## 项目结构

项目采用模块化结构设计，主要包含以下目录：

```
UDPCommunicator/
├── Core/                   # 核心功能模块
│   ├── Authentication.h/cpp  # 用户认证逻辑
│   └── AppManager.h/cpp      # 应用状态管理
├── UI/                     # 用户界面模块
│   ├── LoginWindow.h/cpp     # 登录界面
│   ├── ModeSelectionWindow.h/cpp  # 模式选择界面
│   └── CommunicationWindow.h/cpp  # 通信界面
├── Network/                # 网络通信模块
│   └── UDPManager.h/cpp      # UDP通信管理
├── Utils/                  # 实用工具模块
│   └── Logger.h/cpp          # 日志记录工具
└── Resources/              # 资源文件目录
```

## 文件职责详解

### 主程序文件

- **main.cpp**：程序入口点，初始化应用程序，创建和连接主要窗口对象，建立信号-槽连接链

### Core 模块（核心功能）

- **Authentication.h/cpp**：
  - 实现用户认证系统
  - 管理用户账号和密码
  - 提供身份验证功能
  - 默认内置管理员账号

- **AppManager.h/cpp**：
  - 采用单例模式管理应用程序状态
  - 定义和控制通信模式（本地/远程）
  - 确保模式互斥性
  - 提供状态变更通知机制

### UI 模块（用户界面）

- **LoginWindow.h/cpp**：
  - 实现用户登录界面
  - 处理用户名和密码输入
  - 验证用户身份
  - 发出登录成功信号

- **ModeSelectionWindow.h/cpp**：
  - 实现模式选择界面
  - 提供本地和远程两种通信模式选择
  - 发出模式选择信号

- **CommunicationWindow.h/cpp**：
  - 实现通信操作界面
  - 显示和处理消息发送/接收
  - 管理连接配置（IP和端口）
  - 显示连接状态和ping测试结果
  - 提供返回模式选择的功能

### Network 模块（网络通信）

- **UDPManager.h/cpp**：
  - 封装UDP网络通信功能
  - 处理消息的发送和接收
  - 管理网络连接状态
  - 执行Ping测试
  - 根据通信模式调整监听端口
  - 管理多平台兼容性（Windows/Linux）

### Utils 模块（实用工具）

- **Logger.h/cpp**：
  - 实现日志记录系统（单例模式）
  - 提供多级别日志记录（Info/Warning/Error）
  - 记录时间戳和日志级别
  - 将日志保存到文件

## 技术实现重点

1. **认证系统实现**：
   - 通过QMap存储用户名和密码映射
   - 简单的账号验证逻辑

2. **模式管理实现**：
   - 使用枚举类型定义通信模式
   - 通过单例模式的AppManager确保模式互斥
   - 使用信号-槽机制通知模式变更

3. **UDP通信实现**：
   - 基于QUdpSocket实现UDP通信
   - 通过不同端口区分本地和远程模式（7777/7779）
   - 使用QNetworkDatagram处理数据包
   - 实现简单的连接测试和Ping功能

4. **UI流程控制**：
   - 使用信号-槽机制实现界面切换
   - 通过lambda表达式处理界面逻辑
   - 动态创建和管理通信窗口

5. **日志系统实现**：
   - 使用QFile和QTextStream管理日志文件
   - 格式化日志条目（时间戳+级别+消息）
   - 单例模式确保全局一致性

## 开发环境

- Qt框架 5.15 或更高版本
- C++11 或更高版本
- 支持Windows和Linux/macOS平台

## 使用方法

1. **登录系统**：
   - 启动应用程序，输入用户名和密码
   - 默认账号：admin/password 或 user/123456

2. **选择通信模式**：
   - 登录成功后选择通信模式（本地或远程）

3. **配置连接**：
   - 输入目标IP地址和端口（默认127.0.0.1:8888）
   - 点击"连接"按钮建立连接
   - 查看连接状态和Ping测试结果

4. **消息收发**：
   - 在消息输入框中输入要发送的消息
   - 点击"发送"按钮发送消息
   - 接收到的消息会显示在消息记录区域

5. **返回模式选择**：
   - 点击"返回"按钮回到模式选择界面

## 注意事项

1. 本地模式和远程模式不能同时运行
2. 本地模式默认监听端口为7777
3. 远程模式默认监听端口为7779
4. 应用程序会在当前目录下创建application.log日志文件
5. 连接前会进行Ping测试以确认目标可达性

## 扩展思路

1. 添加数据加密功能增强安全性
2. 实现更完善的用户管理系统
3. 添加消息历史记录功能
4. 优化网络连接管理，增加自动重连功能
5. 扩展为支持多种网络协议（TCP/UDP/HTTP等）

## 许可证

本项目基于MIT许可证开源，仅用于学习和教育目的。
